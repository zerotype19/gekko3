name = "gekko3-core"
main = "src/index.ts"
compatibility_date = "2024-01-01"

[durable_objects]
bindings = [
  { name = "GATEKEEPER_DO", class_name = "GatekeeperDO" }
]

[[migrations]]
tag = "v1"
new_classes = ["GatekeeperDO"]

[[d1_databases]]
binding = "DB"
database_name = "gekko3-ledger"
database_id = "df2c1409-2376-4075-83ba-3e9fe6fe5ac3"

[env.production]
vars = { ENV = "production" }

[env.staging]
vars = { ENV = "staging" }

# Secrets (set via: wrangler secret put <NAME>)
# TRADIER_ACCESS_TOKEN
# TRADIER_ACCOUNT_ID
# API_SECRET

# Cron triggers for EOD reporting
[triggers]
crons = ["30 21 * * 1-5"]  # 4:30 PM ET (21:30 UTC) every weekday (Monday-Friday)
# Note: Adjust for Daylight Savings Time (EDT = UTC-4, EST = UTC-5)
# Current: 21:30 UTC = 4:30 PM EST / 5:30 PM EDT

